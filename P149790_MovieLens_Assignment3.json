{"paragraphs":[{"text":"%md\n\n###This assignment explores the MovieLens 100k dataset, which consists of 100,000 ratings from 1,000 users on 1,700 movies, released in 1998.\n","user":"anonymous","dateUpdated":"2025-07-12T04:18:36+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>This assignment explores the MovieLens 100k dataset, which consists of 100,000 ratings from 1,000 users on 1,700 movies, released in 1998.</h3>\n"}]},"apps":[],"jobName":"paragraph_1752292764131_1494125124","id":"20250712-035924_993782815","dateCreated":"2025-07-12T03:59:24+0000","dateStarted":"2025-07-12T04:18:36+0000","dateFinished":"2025-07-12T04:18:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3266"},{"text":"%md\n\nImport the SparkSession and initialize it with a connection to Cassandra.","user":"anonymous","dateUpdated":"2025-07-12T04:18:20+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Import the SparkSession and initialize it with a connection to Cassandra.</p>\n"}]},"apps":[],"jobName":"paragraph_1752293593672_-251102989","id":"20250712-041313_487973876","dateCreated":"2025-07-12T04:13:13+0000","dateStarted":"2025-07-12T04:18:20+0000","dateFinished":"2025-07-12T04:18:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3267"},{"title":"Initialize Spark and Cassandra","text":"%pyspark\n\nfrom pyspark.sql import SparkSession\n\nspark = SparkSession.builder \\\n    .appName(\"MovieLens\") \\\n    .config(\"spark.cassandra.connection.host\", \"127.0.0.1\") \\\n    .getOrCreate()\nprint(\"SparkSession initialized!\")","user":"anonymous","dateUpdated":"2025-07-12T04:15:46+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"SparkSession initialized!\n"}]},"apps":[],"jobName":"paragraph_1752292664119_766610926","id":"20250712-035743_2075184284","dateCreated":"2025-07-12T03:57:44+0000","dateStarted":"2025-07-12T04:13:02+0000","dateFinished":"2025-07-12T04:13:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3268"},{"text":"%md\n\nDownload u.user data from website : https://grouplens.org/datasets/movielens/\n","user":"anonymous","dateUpdated":"2025-07-12T04:20:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Download u.user data from website : https://grouplens.org/datasets/movielens/</p>\n"}]},"apps":[],"jobName":"paragraph_1752293927746_1871078355","id":"20250712-041847_1190908073","dateCreated":"2025-07-12T04:18:47+0000","dateStarted":"2025-07-12T04:20:24+0000","dateFinished":"2025-07-12T04:20:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3269"},{"text":"%sh\n\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.user -O /tmp/u.user\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.data -O /tmp/u.data\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.item -O /tmp/u.item\n","user":"anonymous","dateUpdated":"2025-07-12T05:27:41+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2025-07-12 04:22:29--  http://media.sundog-soft.com/hadoop/ml-100k/u.user\nResolving media.sundog-soft.com (media.sundog-soft.com)... 3.5.28.69, 16.182.38.33, 3.5.29.43, ...\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|3.5.28.69|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 22628 (22K) [text/plain]\nSaving to: ‘/tmp/u.user’\n\n     0K .......... .......... ..                              100% 88.1K=0.3s\n\n2025-07-12 04:22:30 (88.1 KB/s) - ‘/tmp/u.user’ saved [22628/22628]\n\n--2025-07-12 04:22:30--  http://media.sundog-soft.com/hadoop/ml-100k/u.data\nResolving media.sundog-soft.com (media.sundog-soft.com)... 16.182.38.33, 3.5.29.43, 52.216.106.148, ...\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|16.182.38.33|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 2079229 (2.0M) [application/octet-stream]\nSaving to: ‘/tmp/u.data’\n\n     0K .......... .......... .......... .......... ..........  2%  107K 18s\n    50K .......... .......... .......... .......... ..........  4% 1.09M 10s\n   100K .......... .......... .......... .......... ..........  7%  261K 9s\n   150K .......... .......... .......... .......... ..........  9% 11.0M 6s\n   200K .......... .......... .......... .......... .......... 12%  220K 7s\n   250K .......... .......... .......... .......... .......... 14% 10.4M 5s\n   300K .......... .......... .......... .......... .......... 17% 12.6M 5s\n   350K .......... .......... .......... .......... .......... 19%  104K 6s\n   400K .......... .......... .......... .......... .......... 22% 24.5M 5s\n   450K .......... .......... .......... .......... .......... 24% 46.6M 4s\n   500K .......... .......... .......... .......... .......... 27% 57.3M 4s\n   550K .......... .......... .......... .......... .......... 29% 50.8M 3s\n   600K .......... .......... .......... .......... .......... 32%  159M 3s\n   650K .......... .......... .......... .......... .......... 34% 48.3M 3s\n   700K .......... .......... .......... .......... .......... 36% 71.9M 2s\n   750K .......... .......... .......... .......... .......... 39%  129M 2s\n   800K .......... .......... .......... .......... .......... 41%  101M 2s\n   850K .......... .......... .......... .......... .......... 44%  221K 2s\n   900K .......... .......... .......... .......... .......... 46% 13.9M 2s\n   950K .......... .......... .......... .......... .......... 49% 13.1M 2s\n  1000K .......... .......... .......... .......... .......... 51%  108K 2s\n  1050K .......... .......... .......... .......... .......... 54% 8.96M 2s\n  1100K .......... .......... .......... .......... .......... 56% 18.5M 2s\n  1150K .......... .......... .......... .......... .......... 59% 35.9M 1s\n  1200K .......... .......... .......... .......... .......... 61% 28.7M 1s\n  1250K .......... .......... .......... .......... .......... 64% 38.4M 1s\n  1300K .......... .......... .......... .......... .......... 66%  227K 1s\n  1350K .......... .......... .......... .......... .......... 68% 8.18M 1s\n  1400K .......... .......... .......... .......... .......... 71% 12.0M 1s\n  1450K .......... .......... .......... .......... .......... 73% 10.7M 1s\n  1500K .......... .......... .......... .......... .......... 76%  233K 1s\n  1550K .......... .......... .......... .......... .......... 78% 4.65M 1s\n  1600K .......... .......... .......... .......... .......... 81% 12.0M 1s\n  1650K .......... .......... .......... .......... .......... 83% 11.2M 1s\n  1700K .......... .......... .......... .......... .......... 86% 11.2M 0s\n  1750K .......... .......... .......... .......... .......... 88%  228K 0s\n  1800K .......... .......... .......... .......... .......... 91% 10.6M 0s\n  1850K .......... .......... .......... .......... .......... 93% 11.0M 0s\n  1900K .......... .......... .......... .......... .......... 96% 11.1M 0s\n  1950K .......... .......... .......... .......... .......... 98%  231K 0s\n  2000K .......... .......... ..........                      100% 6.28M=3.1s\n\n2025-07-12 04:22:33 (663 KB/s) - ‘/tmp/u.data’ saved [2079229/2079229]\n\n--2025-07-12 04:22:33--  http://media.sundog-soft.com/hadoop/ml-100k/u.item\nResolving media.sundog-soft.com (media.sundog-soft.com)... 52.217.117.25, 52.217.205.81, 52.217.174.241, ...\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|52.217.117.25|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 236344 (231K) [application/octet-stream]\nSaving to: ‘/tmp/u.item’\n\n     0K .......... .......... .......... .......... .......... 21% 95.2K 2s\n    50K .......... .......... .......... .......... .......... 43% 1.11M 1s\n   100K .......... .......... .......... .......... .......... 64%  227K 0s\n   150K .......... .......... .......... .......... .......... 86% 11.3M 0s\n   200K .......... .......... ..........                      100%  121K=1.0s\n\n2025-07-12 04:22:35 (220 KB/s) - ‘/tmp/u.item’ saved [236344/236344]\n\n"}]},"apps":[],"jobName":"paragraph_1752294062850_-1788901659","id":"20250712-042102_1893942251","dateCreated":"2025-07-12T04:21:02+0000","dateStarted":"2025-07-12T04:22:29+0000","dateFinished":"2025-07-12T04:22:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3270"},{"text":"%md\n\nCreate a new directory to store the files\n","user":"anonymous","dateUpdated":"2025-07-12T05:04:00+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Create a new directory to store the files</p>\n"}]},"apps":[],"jobName":"paragraph_1752296579026_-1394992943","id":"20250712-050259_1088534748","dateCreated":"2025-07-12T05:02:59+0000","dateStarted":"2025-07-12T05:04:00+0000","dateFinished":"2025-07-12T05:04:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3271"},{"text":"%sh\n\nhadoop fs -mkdir /tmp/ml-100k/","user":"anonymous","dateUpdated":"2025-07-12T05:08:45+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"mkdir: `/tmp/ml-100k': File exists\n"},{"type":"TEXT","data":"ExitValue: 1"}]},"apps":[],"jobName":"paragraph_1752296506386_1164848758","id":"20250712-050146_564616850","dateCreated":"2025-07-12T05:01:46+0000","dateStarted":"2025-07-12T05:08:45+0000","dateFinished":"2025-07-12T05:08:49+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:3272"},{"text":"%md\n\nImport files to HDFS location","user":"anonymous","dateUpdated":"2025-07-12T05:22:25+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Import files to HDFS location</p>\n"}]},"apps":[],"jobName":"paragraph_1752296957509_490411296","id":"20250712-050917_1571524234","dateCreated":"2025-07-12T05:09:17+0000","dateStarted":"2025-07-12T05:22:25+0000","dateFinished":"2025-07-12T05:22:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3273"},{"text":"%sh\n\nhadoop fs -put /tmp/u.user /tmp/ml-100k/\nhadoop fs -put /tmp/u.data /tmp/ml-100k/\nhadoop fs -put /tmp/u.item /tmp/ml-100k/","user":"anonymous","dateUpdated":"2025-07-12T05:09:12+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"put: `/tmp/ml-100k/u.user': File exists\nput: `/tmp/ml-100k/u.data': File exists\nput: `/tmp/ml-100k/u.item': File exists\n"},{"type":"TEXT","data":"ExitValue: 1"}]},"apps":[],"jobName":"paragraph_1752294290588_806538324","id":"20250712-042450_1807567380","dateCreated":"2025-07-12T04:24:50+0000","dateStarted":"2025-07-12T05:09:12+0000","dateFinished":"2025-07-12T05:09:15+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:3274"},{"text":"%md\n\nCreate users table in Cassandra in PuTTY for user file\n\n```\n\ncqlsh:movielens> CREATE TABLE users (\n             ...   user_id int,\n             ...   age int,\n             ...   gender text,\n             ...   occupation text,\n             ...   zip text,\n             ... PRIMARY KEY (user_id));\n```","user":"anonymous","dateUpdated":"2025-07-12T05:10:13+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Create users table in Cassandra in PuTTY for user file</p>\n<pre><code>cqlsh:movielens&gt; CREATE TABLE users (\n             ...   user_id int,\n             ...   age int,\n             ...   gender text,\n             ...   occupation text,\n             ...   zip text,\n             ... PRIMARY KEY (user_id));\n</code></pre>\n"}]},"apps":[],"jobName":"paragraph_1752295802382_-577046080","id":"20250712-045002_1145209754","dateCreated":"2025-07-12T04:50:02+0000","dateStarted":"2025-07-12T05:10:13+0000","dateFinished":"2025-07-12T05:10:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3275"},{"text":"%md\n\nCreate titles table in Cassandra in PuTTY for item file\n\n```\ncqlsh:movielens> CREATE TABLE titles (\n             ...   movieid int PRIMARY KEY,\n             ...   title text,\n             ...   unknown int,\n             ...   action int,\n             ...   adventure int,\n             ...   animation int,\n             ...   children int,\n             ...   comedy int,\n             ...   crime int,\n             ...   documentary int,\n             ...   drama int,\n             ...   fantasy int,\n             ...   filmnoir int,\n             ...   horror int,\n             ...   musical int,\n             ...   mystery int,\n             ...   romance int,\n             ...   scifi int,\n             ...   thriller int,\n             ...   war int,\n             ...   western int);\n```","user":"anonymous","dateUpdated":"2025-07-12T05:10:20+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Create titles table in Cassandra in PuTTY for item file</p>\n<pre><code>cqlsh:movielens&gt; CREATE TABLE titles (\n             ...   movieid int PRIMARY KEY,\n             ...   title text,\n             ...   unknown int,\n             ...   action int,\n             ...   adventure int,\n             ...   animation int,\n             ...   children int,\n             ...   comedy int,\n             ...   crime int,\n             ...   documentary int,\n             ...   drama int,\n             ...   fantasy int,\n             ...   filmnoir int,\n             ...   horror int,\n             ...   musical int,\n             ...   mystery int,\n             ...   romance int,\n             ...   scifi int,\n             ...   thriller int,\n             ...   war int,\n             ...   western int);\n</code></pre>\n"}]},"apps":[],"jobName":"paragraph_1752295617620_-451677591","id":"20250712-044657_1231069329","dateCreated":"2025-07-12T04:46:57+0000","dateStarted":"2025-07-12T05:10:20+0000","dateFinished":"2025-07-12T05:10:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3276"},{"text":"%md\n\nCreate ratings table in Cassandra in PuTTY for data file\n\n```\ncqlsh:movielens> CREATE TABLE ratings (\n             ...   user_id int,\n             ...   movieid int,\n             ...   rating int,\n             ...   PRIMARY KEY (user_id, movieid));\n```","user":"anonymous","dateUpdated":"2025-07-12T05:10:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Create ratings table in Cassandra in PuTTY for data file</p>\n<pre><code>cqlsh:movielens&gt; CREATE TABLE ratings (\n             ...   user_id int,\n             ...   movieid int,\n             ...   rating int,\n             ...   PRIMARY KEY (user_id, movieid));\n</code></pre>\n"}]},"apps":[],"jobName":"paragraph_1752295435660_-1564800487","id":"20250712-044355_997129632","dateCreated":"2025-07-12T04:43:55+0000","dateStarted":"2025-07-12T05:10:27+0000","dateFinished":"2025-07-12T05:10:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3277"},{"text":"%md\n\n###Create Resilient Distributed Dataset (RDD) objects","user":"anonymous","dateUpdated":"2025-07-12T05:27:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Create Resilient Distributed Dataset (RDD) objects</h3>\n"}]},"apps":[],"jobName":"paragraph_1752296319977_682790385","id":"20250712-045839_685706834","dateCreated":"2025-07-12T04:58:39+0000","dateStarted":"2025-07-12T05:27:47+0000","dateFinished":"2025-07-12T05:27:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3278"},{"text":"%md\nCreate users RDD and DataFrame ","user":"anonymous","dateUpdated":"2025-07-12T05:28:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Create users RDD and DataFrame</p>\n"}]},"apps":[],"jobName":"paragraph_1752298073924_533894499","id":"20250712-052753_502805446","dateCreated":"2025-07-12T05:27:53+0000","dateStarted":"2025-07-12T05:28:38+0000","dateFinished":"2025-07-12T05:28:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3279"},{"text":"%pyspark\n\nfrom pyspark.sql import Row\nfrom pyspark.sql import functions as F\n\n# ParseInput function\ndef parseInput(line):\n    fields = line.split('|')\n    return Row(user_id=int(fields[0]), age=int(fields[1]), gender=fields[2], occupation=fields[3], zip=fields[4])\n\n# Load raw user data from HDFS\nlines = spark.sparkContext.textFile(\"hdfs:///tmp/ml-100k/u.user\")\n\n# Apply transformation\nusers = lines.map(parseInput)\n\n# Create DataFrame\nusersDataset = spark.createDataFrame(users)\n\n# Write to Cassandra\nusersDataset.write \\\n    .format(\"org.apache.spark.sql.cassandra\") \\\n    .mode(\"append\") \\\n    .options(table=\"users\", keyspace=\"movielens\") \\\n    .save()\n\n# Read back from Cassandra\nreadUsers = spark.read \\\n    .format(\"org.apache.spark.sql.cassandra\") \\\n    .options(table=\"users\", keyspace=\"movielens\") \\\n    .load()\n\nreadUsers.show()\n","user":"anonymous","dateUpdated":"2025-07-12T05:27:53+0000","config":{"colWidth":11,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":414,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":true},"editorMode":"ace/mode/python","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---+------+----------+-----+\n|user_id|age|gender|occupation|  zip|\n+-------+---+------+----------+-----+\n|    143| 42|     M|technician|08832|\n|    909| 50|     F|  educator|53171|\n|    468| 28|     M|  engineer|02341|\n|    583| 44|     M|  engineer|29631|\n|    403| 37|     M|     other|06811|\n|    546| 36|     M| executive|22911|\n|    771| 26|     M|   student|15232|\n|    618| 15|     F|   student|44212|\n|    411| 34|     M|  educator|44691|\n|    471| 10|     M|   student|77459|\n|    845| 64|     M|    doctor|97405|\n|    486| 39|     M|  educator|93101|\n|    288| 34|     M| marketing|23226|\n|    652| 35|     M|     other|22911|\n|    894| 47|     M|  educator|74075|\n|    533| 43|     M| librarian|02324|\n|    834| 26|     M|     other|64153|\n|     74| 39|     M| scientist|T8H1N|\n|    359| 22|     M|   student|61801|\n|    215| 35|     M|programmer|63033|\n+-------+---+------+----------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1752296224767_1359609673","id":"20250712-045704_718389359","dateCreated":"2025-07-12T04:57:04+0000","dateStarted":"2025-07-12T05:11:02+0000","dateFinished":"2025-07-12T05:11:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3280"},{"text":"%md\nCreate titles RDD and DataFrame\n","user":"anonymous","dateUpdated":"2025-07-12T05:30:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Create titles RDD and DataFrame</p>\n"}]},"apps":[],"jobName":"paragraph_1752298126268_-272661789","id":"20250712-052846_1628669876","dateCreated":"2025-07-12T05:28:46+0000","dateStarted":"2025-07-12T05:30:04+0000","dateFinished":"2025-07-12T05:30:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3281"},{"text":"%pyspark\r\n\r\nfrom pyspark.sql import Row\r\nfrom pyspark.sql import functions as F\r\n\r\n# Parse movie lines\r\ndef parse_movie(line):\r\n    fields = line.split('|')\r\n    return Row(\r\n        movieid=int(fields[0]),\r\n        title=fields[1],\r\n        unknown=int(fields[5]),\r\n        action=int(fields[6]),\r\n        adventure=int(fields[7]),\r\n        animation=int(fields[8]),\r\n        children=int(fields[9]),\r\n        comedy=int(fields[10]),\r\n        crime=int(fields[11]),\r\n        documentary=int(fields[12]),\r\n        drama=int(fields[13]),\r\n        fantasy=int(fields[14]),\r\n        filmnoir=int(fields[15]),\r\n        horror=int(fields[16]),\r\n        musical=int(fields[17]),\r\n        mystery=int(fields[18]),\r\n        romance=int(fields[19]),\r\n        scifi=int(fields[20]),\r\n        thriller=int(fields[21]),\r\n        war=int(fields[22]),\r\n        western=int(fields[23])\r\n    )\r\n\r\n# Load raw movie data from HDFS\r\nmovie_lines = spark.sparkContext.textFile(\"hdfs:///tmp/ml-100k/u.item\")\r\n\r\n# Apply parsing\r\nmovies = movie_lines.map(parse_movie)\r\n\r\n# Convert to DataFrame\r\nmovies_df = spark.createDataFrame(movies)\r\n\r\n# Write to Cassandra\r\nmovies_df.write \\\r\n    .format(\"org.apache.spark.sql.cassandra\") \\\r\n    .mode(\"append\") \\\r\n    .options(table=\"titles\", keyspace=\"movielens\") \\\r\n    .save()\r\n\r\n# Read back from Cassandra\r\nreadMovies = spark.read \\\r\n    .format(\"org.apache.spark.sql.cassandra\") \\\r\n    .options(table=\"titles\", keyspace=\"movielens\") \\\r\n    .load()\r\n\r\n# Show result\r\nreadMovies.show()","user":"anonymous","dateUpdated":"2025-07-12T05:25:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+--------------------+-------+---+-------+\n|movieid|action|adventure|animation|children|comedy|crime|documentary|drama|fantasy|filmnoir|horror|musical|mystery|romance|scifi|thriller|               title|unknown|war|western|\n+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+--------------------+-------+---+-------+\n|    143|     0|        0|        0|       0|     0|    0|          0|    0|      0|       0|     0|      1|      0|      0|    0|       0|Sound of Music, T...|      0|  0|      0|\n|    909|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|Dangerous Beauty ...|      0|  0|      0|\n|    468|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|         Rudy (1993)|      0|  0|      0|\n|    583|     0|        0|        0|       0|     0|    1|          0|    0|      0|       0|     0|      0|      0|      0|    0|       1|Romeo Is Bleeding...|      0|  0|      0|\n|   1189|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|  Prefontaine (1997)|      0|  0|      0|\n|    403|     1|        1|        0|       0|     0|    1|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|       Batman (1989)|      0|  0|      0|\n|    546|     1|        0|        0|       0|     0|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       1| Broken Arrow (1996)|      0|  0|      0|\n|   1049|     0|        0|        0|       0|     1|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       0| House Arrest (1996)|      0|  0|      0|\n|   1327|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|     Captives (1994)|      0|  0|      0|\n|    771|     1|        0|        0|       0|     0|    0|          0|    0|      0|       0|     0|      0|      0|      0|    1|       1|Johnny Mnemonic (...|      0|  0|      0|\n|    618|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|       Picnic (1955)|      0|  0|      0|\n|    411|     0|        0|        0|       0|     1|    0|          0|    0|      1|       0|     0|      0|      0|      1|    1|       0|Nutty Professor, ...|      0|  0|      0|\n|    471|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|Courage Under Fir...|      0|  1|      0|\n|   1125|     0|        0|        0|       0|     0|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       1|Innocents, The (1...|      0|  0|      0|\n|    845|     0|        0|        0|       0|     1|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       0|That Thing You Do...|      0|  0|      0|\n|    486|     0|        0|        0|       0|     1|    0|          0|    0|      0|       0|     0|      0|      0|      1|    0|       0|      Sabrina (1954)|      0|  0|      0|\n|   1045|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|     Fearless (1993)|      0|  0|      0|\n|    288|     0|        0|        0|       0|     0|    0|          0|    0|      0|       0|     1|      0|      0|      0|    0|       1|       Scream (1996)|      0|  0|      0|\n|    652|     0|        0|        0|       0|     1|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|Rosencrantz and G...|      0|  0|      0|\n|   1101|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      1|      0|    0|       0|Six Degrees of Se...|      0|  0|      0|\n+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+--------------------+-------+---+-------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1752297070325_-1641712222","id":"20250712-051110_1453811164","dateCreated":"2025-07-12T05:11:10+0000","dateStarted":"2025-07-12T05:25:39+0000","dateFinished":"2025-07-12T05:25:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3282"},{"text":"%md\nCreate ratings RDD and DataFrame\n","user":"anonymous","dateUpdated":"2025-07-12T05:30:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Create ratings RDD and DataFrame</p>\n"}]},"apps":[],"jobName":"paragraph_1752298208846_1043453640","id":"20250712-053008_277860675","dateCreated":"2025-07-12T05:30:08+0000","dateStarted":"2025-07-12T05:30:28+0000","dateFinished":"2025-07-12T05:30:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3283"},{"text":"%pyspark\r\n\r\nfrom pyspark.sql import Row\r\nfrom pyspark.sql import functions as F\r\n\r\n# Parse each line into (user_id, movieid, rating)\r\ndef parseInput2(line):\r\n    fields = line.split('\\t')\r\n    return Row(user_id=int(fields[0]), movieid=int(fields[1]), rating=int(fields[2]))\r\n\r\n# Load ratings data from HDFS\r\nlines = spark.sparkContext.textFile(\"hdfs:///tmp/ml-100k/u.data\")\r\n\r\n# Map lines to Rows\r\nratings = lines.map(parseInput2)\r\n\r\n# Create DataFrame from ratings\r\nratingsDataset = spark.createDataFrame(ratings)\r\n\r\n# Write to Cassandra\r\nratingsDataset.write \\\r\n    .format(\"org.apache.spark.sql.cassandra\") \\\r\n    .mode(\"append\") \\\r\n    .options(table=\"ratings\", keyspace=\"movielens\") \\\r\n    .save()\r\n\r\n# Read back from Cassandra\r\nreadRatings = spark.read \\\r\n    .format(\"org.apache.spark.sql.cassandra\") \\\r\n    .options(table=\"ratings\", keyspace=\"movielens\") \\\r\n    .load()\r\n\r\n# Show the result\r\nreadRatings.show()","user":"anonymous","dateUpdated":"2025-07-12T05:28:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------+------+\n|user_id|movieid|rating|\n+-------+-------+------+\n|    143|    258|     3|\n|    143|    271|     4|\n|    143|    272|     4|\n|    143|    286|     2|\n|    143|    288|     5|\n|    143|    294|     3|\n|    143|    307|     4|\n|    143|    313|     5|\n|    143|    315|     4|\n|    143|    322|     4|\n|    143|    323|     3|\n|    143|    325|     5|\n|    143|    326|     5|\n|    143|    328|     4|\n|    143|    331|     5|\n|    143|    333|     5|\n|    143|    347|     5|\n|    143|    682|     3|\n|    143|    690|     2|\n|    143|   1038|     3|\n+-------+-------+------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1752297990508_-621829900","id":"20250712-052630_1445904932","dateCreated":"2025-07-12T05:26:30+0000","dateStarted":"2025-07-12T05:28:49+0000","dateFinished":"2025-07-12T05:28:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3284"},{"title":"Load u.user Data","text":"%md\n### i) Calculate the average rating for each movie","user":"anonymous","dateUpdated":"2025-07-12T05:35:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>i) Calculate the average rating for each movie</h3>\n"}]},"apps":[],"jobName":"paragraph_1752292664122_765456680","id":"20250712-035743_1437407095","dateCreated":"2025-07-12T03:57:44+0000","dateStarted":"2025-07-12T05:35:04+0000","dateFinished":"2025-07-12T05:35:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3285"},{"title":"Write users to Cassandra","text":"%pyspark\r\n\r\nfrom pyspark.sql.functions import avg\r\n\r\n# Join ratings and movie metadata on movieid\r\njoined = readRatings.join(readMovies, on=\"movieid\")\r\n\r\n# Group by title and compute average rating\r\navg_ratings = joined.groupBy(\"title\").agg(avg(\"rating\").alias(\"avg_rating\"))\r\n\r\n# Order by average rating descending and get top 20\r\ntop20_movies = avg_ratings.orderBy(\"avg_rating\", ascending=False).limit(20)\r\n\r\n# Show the result\r\ntop20_movies.show()","user":"anonymous","dateUpdated":"2025-07-12T05:40:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-----------------+\n|               title|       avg_rating|\n+--------------------+-----------------+\n|They Made Me a Cr...|              5.0|\n|  Prefontaine (1997)|              5.0|\n|     Star Kid (1997)|              5.0|\n|Great Day in Harl...|              5.0|\n|Aiqing wansui (1994)|              5.0|\n|Marlene Dietrich:...|              5.0|\n|Someone Else's Am...|              5.0|\n|Saint of Fort Was...|              5.0|\n|Entertaining Ange...|              5.0|\n|Santa with Muscle...|              5.0|\n|Pather Panchali (...|            4.625|\n|         Anna (1996)|              4.5|\n|      Everest (1998)|              4.5|\n|Some Mother's Son...|              4.5|\n|Maya Lin: A Stron...|              4.5|\n|Close Shave, A (1...|4.491071428571429|\n|Schindler's List ...|4.466442953020135|\n|Wrong Trousers, T...|4.466101694915254|\n|   Casablanca (1942)| 4.45679012345679|\n|Wallace & Gromit:...|4.447761194029851|\n+--------------------+-----------------+\n\n"}]},"apps":[],"jobName":"paragraph_1752292664122_765456680","id":"20250712-035743_1699493833","dateCreated":"2025-07-12T03:57:44+0000","dateStarted":"2025-07-12T05:40:35+0000","dateFinished":"2025-07-12T05:40:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3286"},{"title":"Load u.data (Ratings)","text":"%md\n### ii) Identify the top movies with the highest average ratings","user":"anonymous","dateUpdated":"2025-07-12T05:46:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>ii) Identify the top movies with the highest average ratings</h3>\n"}]},"apps":[],"jobName":"paragraph_1752292664122_765456680","id":"20250712-035743_1206371844","dateCreated":"2025-07-12T03:57:44+0000","dateStarted":"2025-07-12T05:46:31+0000","dateFinished":"2025-07-12T05:46:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3287"},{"title":"Q1: Average rating for each movie","text":"%pyspark\n\ntop_20_movies.limit(10).show()","user":"anonymous","dateUpdated":"2025-07-12T05:41:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----------+\n|               title|avg_rating|\n+--------------------+----------+\n|Entertaining Ange...|       5.0|\n|Saint of Fort Was...|       5.0|\n|Someone Else's Am...|       5.0|\n|     Star Kid (1997)|       5.0|\n|  Prefontaine (1997)|       5.0|\n|Aiqing wansui (1994)|       5.0|\n|Marlene Dietrich:...|       5.0|\n|Great Day in Harl...|       5.0|\n|They Made Me a Cr...|       5.0|\n|Santa with Muscle...|       5.0|\n+--------------------+----------+\n\n"}]},"apps":[],"jobName":"paragraph_1752292664122_765456680","id":"20250712-035743_986588744","dateCreated":"2025-07-12T03:57:44+0000","dateStarted":"2025-07-12T05:42:00+0000","dateFinished":"2025-07-12T05:42:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3288"},{"text":"%md\n### iii) Find the users who have rated at least 50 movies and identify their favourite movie genres\n","user":"anonymous","dateUpdated":"2025-07-12T05:43:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>iii) Find the users who have rated at least 50 movies and identify their favourite movie genres</h3>\n"}]},"apps":[],"jobName":"paragraph_1752298931128_-559917096","id":"20250712-054211_97016079","dateCreated":"2025-07-12T05:42:11+0000","dateStarted":"2025-07-12T05:43:55+0000","dateFinished":"2025-07-12T05:43:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3289"},{"title":"Q2: Top 10 highest average-rated movies","text":"%pyspark\r\n\r\nfrom pyspark.sql.functions import col, count, row_number\r\nfrom pyspark.sql.window import Window\r\n\r\n# Filter users who rated at least 50 movies\r\nfiltered_users = readRatings.groupBy(\"user_id\") \\\r\n    .agg(count(\"*\").alias(\"num_ratings\")) \\\r\n    .filter(col(\"num_ratings\") >= 50) \\\r\n    .select(\"user_id\")\r\n\r\n# Join ratings with filtered users and titles\r\nfiltered_ratings = readRatings \\\r\n    .join(filtered_users, on=\"user_id\") \\\r\n    .join(readMovies, on=\"movieid\")\r\n\r\n# Unpivot genre columns\r\ngenre_columns = [\r\n    \"unknown\", \"action\", \"adventure\", \"animation\", \"children\", \"comedy\", \"crime\",\r\n    \"documentary\", \"drama\", \"fantasy\", \"filmNoir\", \"horror\", \"musical\", \"mystery\",\r\n    \"romance\", \"sciFi\", \"thriller\", \"war\", \"western\"\r\n]\r\n\r\n# Flatten genres (manual unpivot via union)\r\nuser_genres = None\r\nfor genre in genre_columns:\r\n    temp = filtered_ratings.filter(col(genre) == 1) \\\r\n        .select(\"user_id\").withColumn(\"genre\", F.lit(genre))\r\n    user_genres = temp if user_genres is None else user_genres.union(temp)\r\n\r\n# Count genre frequencies per user\r\nuser_genre_counts = user_genres.groupBy(\"user_id\", \"genre\") \\\r\n    .agg(count(\"*\").alias(\"count\"))\r\n\r\n# Rank genres per user\r\nwindowSpec = Window.partitionBy(\"user_id\").orderBy(col(\"count\").desc())\r\n\r\nranked_genres = user_genre_counts.withColumn(\"rank\", row_number().over(windowSpec))\r\n\r\n# Select top genre per user\r\ntop_genres_per_user = ranked_genres.filter(col(\"rank\") == 1) \\\r\n    .orderBy(col(\"count\").desc())\r\n\r\ntop_genres_per_user.select(\"user_id\", \"genre\", \"count\").show()","user":"anonymous","dateUpdated":"2025-07-12T05:46:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------+-----+\n|user_id| genre|count|\n+-------+------+-----+\n|    655| drama|  410|\n|    405| drama|  309|\n|    537| drama|  251|\n|    450| drama|  237|\n|     13| drama|  218|\n|    234| drama|  213|\n|    416| drama|  212|\n|    279|comedy|  211|\n|    201| drama|  196|\n|    393|comedy|  191|\n|    181| drama|  188|\n|    303|comedy|  184|\n|    334| drama|  174|\n|     90| drama|  173|\n|    378| drama|  170|\n|    276| drama|  168|\n|    429| drama|  167|\n|    474| drama|  166|\n|    293| drama|  165|\n|    308| drama|  163|\n+-------+------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1752292664123_765071931","id":"20250712-035743_132487369","dateCreated":"2025-07-12T03:57:44+0000","dateStarted":"2025-07-12T05:46:38+0000","dateFinished":"2025-07-12T05:47:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3290"},{"title":"Q3: Users who rated ≥50 movies","text":"%md\n### iv) Find all the users are less than 20 years old","user":"anonymous","dateUpdated":"2025-07-12T05:54:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>iv) Find all the users are less than 20 years old</h3>\n"}]},"apps":[],"jobName":"paragraph_1752292664123_765071931","id":"20250712-035743_59970947","dateCreated":"2025-07-12T03:57:44+0000","dateStarted":"2025-07-12T05:54:06+0000","dateFinished":"2025-07-12T05:54:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3291"},{"title":"Q4: Users less than 20 years old","text":"%pyspark\n\nless20 = readUsers.filter(\"age < 20\")\n\nless20.show()","user":"anonymous","dateUpdated":"2025-07-12T05:55:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---+------+----------+-----+\n|user_id|age|gender|occupation|  zip|\n+-------+---+------+----------+-----+\n|    618| 15|     F|   student|44212|\n|    471| 10|     M|   student|77459|\n|    580| 16|     M|   student|17961|\n|    262| 19|     F|   student|78264|\n|    880| 13|     M|   student|83702|\n|    632| 18|     M|   student|55454|\n|    541| 19|     F|   student|84302|\n|    453| 18|     M|   student|06333|\n|    223| 19|     F|   student|47906|\n|    462| 19|     F|   student|02918|\n|    550| 16|     F|   student|95453|\n|    289| 11|     M|      none|94619|\n|    142| 13|     M|     other|48118|\n|    482| 18|     F|   student|40256|\n|    303| 19|     M|   student|14853|\n|    101| 15|     M|   student|05146|\n|    872| 19|     F|   student|74078|\n|    601| 19|     F|    artist|99687|\n|    817| 19|     M|   student|60152|\n|    710| 19|     M|   student|92020|\n+-------+---+------+----------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1752292664123_765071931","id":"20250712-035743_2059219987","dateCreated":"2025-07-12T03:57:44+0000","dateStarted":"2025-07-12T05:55:57+0000","dateFinished":"2025-07-12T05:55:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3292"},{"text":"%md\n### v) Find all the users whose occupation is \"scientist\" and whose age is between 30 and 40 years old\n","user":"anonymous","dateUpdated":"2025-07-12T05:55:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>v) Find all the users whose occupation is &ldquo;scientist&rdquo; and whose age is between 30 and 40 years old</h3>\n"}]},"apps":[],"jobName":"paragraph_1752299659276_-1316110673","id":"20250712-055419_855353146","dateCreated":"2025-07-12T05:54:19+0000","dateStarted":"2025-07-12T05:55:32+0000","dateFinished":"2025-07-12T05:55:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3293"},{"title":"Q5: Scientists aged 30-40","text":"%pyspark\n\nscientist3040 = readUsers.filter(\n    (col(\"age\") > 30) & (col(\"age\") < 40) & (col(\"occupation\") == \"scientist\"))\n    \nscientist3040.show()","user":"anonymous","dateUpdated":"2025-07-12T05:55:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---+------+----------+-----+\n|user_id|age|gender|occupation|  zip|\n+-------+---+------+----------+-----+\n|     74| 39|     M| scientist|T8H1N|\n|    183| 33|     M| scientist|27708|\n|    107| 39|     M| scientist|60466|\n|    272| 33|     M| scientist|53706|\n|    430| 38|     M| scientist|98199|\n|    643| 39|     M| scientist|55122|\n|    543| 33|     M| scientist|95123|\n|    730| 31|     F| scientist|32114|\n|    337| 37|     M| scientist|10522|\n|    554| 32|     M| scientist|62901|\n|     40| 38|     M| scientist|27514|\n|     71| 39|     M| scientist|98034|\n|    874| 36|     M| scientist|37076|\n|    538| 31|     M| scientist|21010|\n+-------+---+------+----------+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1752292664123_765071931","id":"20250712-035743_822780266","dateCreated":"2025-07-12T03:57:44+0000","dateStarted":"2025-07-12T05:55:59+0000","dateFinished":"2025-07-12T05:56:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3294"},{"text":"\n","user":"anonymous","dateUpdated":"2025-07-12T05:56:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1752299759911_-1681516503","id":"20250712-055559_1971093018","dateCreated":"2025-07-12T05:55:59+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:3295"}],"name":"MovieLens_Assignment","id":"2M2BXY9TE","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}